# 📋 תוכנית בדיקות מקיפה - RAG + Dicta-LM

## מה בודקים? שלוש שכבות + שכבה אחת "מאחורי הקלעים"

### 1. שאלות על הידע
- האם המודל משתמש נכון בחומרי ה-IMPACT? (פודקאסטים, מסמכים, שפה תודעתית וכו')
- האם הוא מבחין בין ידע שקיים לבין דברים שלא כתובים (לא ממציא)?

### 2. שאלות אישיות (כדי להבין הקשר)
- האם המודל שואל חזרה שאלות עדינות שמבררות הקשר?
- האם הוא זוכר מידע בסיסי לאורך כמה הודעות, ומשתמש בו ברוך?

### 3. סמול טוק / אנושיות
- האם השפה זורמת, חמה, לא רובוטית?
- האם הוא שומר על "תדר טל בשן" גם כשמדברים על שטויות.

### 4. שכבת פייפליין: מה-prompt → chunks → תשובה
- האם ה-chunks שנשלפים רלוונטיים?
- האם התשובה באמת נשענת עליהם?
- איפה נכנסת אינטואיציה / "דמיון" של המודל ואיפה ידע מבוסס?

---

## 2. סט בדיקות לידע (RAG / תוכן IMPACT)

### 2.1. שאלות בסיס על מושגים מרכזיים

**מטרה:** לבדוק שהמודל יודע להסביר ליבה תודעתית כמו "תודעה ריאקטיבית/קריאטיבית", "מה שמואר צומח", "אמבטיה רגשית", "מסכה/כובע" וכו'.

**דוגמאות פרומפטים:**
- "תסביר לי בקצרה מה ההבדל בין תודעה ריאקטיבית לתודעה קריאטיבית לפי טל בשן."
- "מה זאת אומרת 'מה שמואר צומח' בהורות?"
- "מה ההבדל בין מסכה לכובע בשפה של טל?"
- "מה זה 'אמבטיה רגשית' ואיך עושים את זה לבד בבית?"

**מה בודקים:**

1. **ב-chunks שנשלפו:**
   - יש לפחות מקור אחד מדויק שמכיל את המושג/הגדרה.
   - אין כמעט רעש לא קשור.

2. **בתשובה:**
   - מופיעה ההבחנה הנכונה (למשל: מסכה = תגובה לפחד, כובע = תפקיד מודע).
   - אין ערבוב מושגים (לא מבלבל גבולות עם רגשות וכו').
   - יש שפה רכה, בגוף ראשון/שני, לא הרצאה נוקשה.

**רובריקה (ציון לצורך בדיקה ידנית):**
- **1–2:** טעות מהותית או בלבול מושגים.
- **3:** נכון חלקית, חסר דיוק/עומק.
- **4–5:** מדויק, תואם את הידע, בשפה "טלית".

---

### 2.2. שאלות יישום (ידע → פרקטיקה)

**מטרה:** לבדוק שהמודל לא רק מצטט, אלא מיישם את המודל על סיטואציה.

**דוגמאות פרומפטים:**
- "הבן שלי בן 6 אומר 'אני אפס', איך לפי IMPACT נכון להגיב?"
- "אני מרגיש שחוק בעבודה, מה זה יכול להגיד על הרצון שלי לפי טל בשן?"
- "יש לי קושי לשים גבול בעבודה, איך עוברים מגבול ריאקטיבי לפרואקטיבי?"

**מה בודקים:**

1. **ב-chunks:**
   - נשלפים חלקים על: רצון חופשי, גבולות, ריאקטיבי/פרואקטיבי, רגשות וכו'.

2. **בתשובה:**
   - קודם כל יש הכרה ברגש ("אני שומע שקשה לך…").
   - אח"כ תובנה תודעתית (שורש הפעולה – פחד או רצון חופשי).
   - אין "עצות ביצועיות" קרות בלי החלק הרגשי.

---

### 2.3. שאלות אמינות / "חורים בידע"

**מטרה:** לבדוק שהמודל לא ממציא דברים שלא קיימים בקורפוס.

**דוגמאות פרומפטים:**
- "תן לי ציטוט מדויק של טל בשן על נושא X" (שאתה יודע שאין עליו ציטוט מפורש).
- "באיזה פרק טל מדבר על נושא Y?" (שאין עליו פרק ייעודי).

**מה בודקים:**
- האם המודל אומר "אין לי ציטוט מדויק" במקום להמציא.
- האם הוא משתמש בשפה של "לפי רוח הדברים, ולא ציטוט מילולי".

---

## 3. סט בדיקות לשאלות אישיות / הקשר

פה אתה בודק אם המודל יודע לפגוש אדם, לא רק להסביר מודל.

### 3.1. פתיחה אישית אחת → כמה צעדים קדימה

**תרחיש:**
אתה פותח בשאלה אישית, ממשיך 4–6 הודעות, ובודק האם המודל שומר הקשר, שואל חזרה, לא קופץ מהר לפתרונות.

**דוגמאות פרומפטים:**
1. "אני בתקופה מאוד עמוסה, מרגיש שהכל עליי, לא יודע מאיפה להתחיל."
2. אחרי התשובה שלו: "אני גם שם לב שאני מתבייש לבקש עזרה."
3. "זה קשור אולי לילדות שלי, שהייתי 'החזק בבית'."

**מה בודקים:**
- האם הוא:
  - מתחיל כל פעם בהכרה ברגש ("אני שומע כמה אתה סוחב שם…")
  - שואל שאלות פתוחות ("מה החלק שהכי כואב לך בעומס הזה?").
  - מחזיק שפה של "שורש הפעולה – פחד או רצון חופשי".

---

### 3.2. בדיקת זיכרון הקשר

באותה שיחה, אחרי 4–5 הודעות, תבדוק אם הוא זוכר:
- שם/תפקיד/קונטקסט שנתת בהתחלה.
- רגש מרכזי שציינת ("מפחד מדחייה", "מרגיש אשמה").

**פרומפט לדוגמה:**
- בתחילת השיחה: "אני אבא לשתי בנות, מרגיש שמפספס אותן."
- אחרי כמה הודעות: "איך אתה היית מסביר את מה שקורה לי כהורה?"

**מה בודקים:**
- האם הוא תופר בחזרה: "כאבא לשתי בנות, אני שומע…" ולא מתייחס אליך כאל אדם אנונימי.

---

## 4. סט בדיקות לסמול טוק / אנושיות

המטרה פה: לראות אם גם בשיחה קלילה הוא נשאר רך, סקרן, לא "חופר" איפה שלא צריך, אבל גם לא רובוט.

**דוגמאות פרומפטים:**
- "משעמם לי עכשיו, בא לי סתם לדבר."
- "ספר לי משהו מצחיק על תודעה."
- "אין לי כוח עכשיו ל'עבודה עצמית', אפשר רק לדבר על חתולים?"

**מה בודקים:**
- האם הוא מאפשר לגיטימציה גם לחוסר חשק לעבוד: "זה בסדר גמור לא לרצות להתעמק עכשיו."
- האם הוא עדיין נשאר עדין, לא מטיף, לא לוחץ אותך לתהליך.
- האם הוא מסיים גם שיחה קלילה בהזמנה רכה, למשל שאלה קטנה, לא "שיעורי בית".

---

## 5. בדיקת הפייפליין: מה-chunks לתשובה

כאן אתה נכנס "מאחורי הקלעים". בכל שיחה מבחן, שמור לכל הודעה:

1. prompt גולמי למודל.
2. ה-chunks שנשלפו (תוכן + מזהים).
3. התשובה הסופית.

### 5.1. צ'קליסט לכל הודעה

עבור כל צעד בשיחה, עובר ידנית (או עם סקריפט שמסמן, אבל השיפוט בסוף אנושי):

1. **רלוונטיות ה-chunks**
   - 0–2: כמעט לא קשור.
   - 3: בערך קשור, אבל חסר חומר.
   - 4–5: מכיל בדיוק את החומרים הנדרשים.

2. **כיסוי מידע (coverage)**
   - האם לפחות אחד מה-chunks כולל תשובה מלאה/דוגמה טובה לסיטואציה?
   - אם לא – אבל התשובה של המודל בכל זאת "יפה" – זה סימן לסיכון הזיה (hallucination).

3. **יישור תשובה ל-chunks**
   - האם אפשר "לעקוב" בתשובה ולראות מאיזה chunk כל חלק הגיע?
   - האם המודל לא מכניס רעיונות שלא מופיעים בכלל בקורפוס?

4. **סגנון ותדר**
   - פתיחה באמפתיה?
   - שיתוף בגוף ראשון / שפה אנושית ("כשאני מרגיש…")
   - סיום בשאלה יוצרת / הזמנה קטנה, לא עצה קטגורית.

---

## 6. איך להריץ את הבדיקות

### הרצה מלאה:
```bash
cd /Users/tzahimoyal/TalBashanAI
source venv/bin/activate
export USE_LOCAL_LLM=true
python3 scripts/comprehensive_test_suite.py
```

### הרצה לפי קטגוריה:
ערוך את `scripts/comprehensive_test_suite.py` והערה/הסר את הקטגוריות שאתה לא רוצה להריץ.

### תוצאות:
הדוח נשמר ב-`test_results.json` עם כל הפרטים:
- שאלות ותשובות
- Chunks שנשלפו
- ציונים אוטומטיים
- זמנים
- הערות

---

## 7. דוגמה לשיחה אחת מלאה

**שיחה אחת:**

1. "מה זה תודעה ריאקטיבית לפי טל בשן?" (ידע)
2. "נראה לי שאני כזה מול אח שלי – אני מתפוצץ עליו בקלות." (יישום אישי)
3. "טוב, עשית לי חשק לברוח עכשיו לנטפליקס 😂" (סמול טוק)

**ואז תעבור על כל שלושת הרבדים:**
- ידע.
- ליווי תודעתי אישי.
- אנושיות/הומור/לגיטימציה לעייפות.

---

## 8. קריטריונים להצלחה

### ציונים מינימליים:
- **ידע:** ממוצע 4+ על כל הקטגוריות
- **שאלות אישיות:** ממוצע 4+ על אמפתיה ושאלות פתוחות
- **סמול טוק:** ממוצע 4+ על לגיטימציה וסיום רך
- **פייפליין:** ממוצע 4+ על רלוונטיות chunks ושימוש בהם

### זמנים:
- זמן ממוצע לשאלה: < 5 שניות (אחרי טעינת מודל)
- זמן מקסימלי: < 10 שניות

### איכות:
- אין הזיות (hallucinations) ב-95% מהמקרים
- שמירה על סגנון טל בשן ב-90% מהמקרים
- זיכרון הקשר ב-80% מהמקרים

